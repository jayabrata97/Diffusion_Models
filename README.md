Denoising Diffusion Probabilistic Model (DDPM) with the help of previous implementations